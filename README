ODDB.org stands for OpenDrugDatabase 
====================================

Date: 2010-05-27

Short Description: ODDB.org is an OpenDrugDatabase that enables the
search for Drugs by their ActiveAgent, Name, Producer, ATC-Code.  You
can do a price comparison between the Original Drug and the Generic by
Clicking on the Drug's Name. The database tells you when the Drug has
been registred in Switzerland. ODDB.org exports the complete Data in the
YAML.org Format (15'881 registred products).

For for more information about the background see:

	* http://www.ywesee.com
	* http://www.oddb.org
	* http://dev.ywesee.com

Requirements
------------

ch.oddb.org has a large set of functionality, and with it a large set of
dependencies:

	* ruby 1.8, mod_ruby, drbsession, apache
  * character-encodings (gem: {{{ sudo gem install character-encodings }}})
  * currency (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/currency; cd currency;
        ruby install.rb config; ruby install.rb setup;
        sudo ruby install.rb install }}})
  * dbi (gentoo: {{{ emerge install ruby-dbi }}} with postgres use flag)
  * gruff (gem: {{{ sudo gem install gruff }}})
  * htmlgrid (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/htmlgrid; cd htmlgrid;
        ruby install.rb config; ruby install.rb setup;
        sudo ruby install.rb install }}})
  * html-parser - three attached files:
    http://trac.ywesee.com/attachment/ticket/226/html-parser.rb
    http://trac.ywesee.com/attachment/ticket/226/sgml-parser.rb
    http://trac.ywesee.com/attachment/ticket/226/formatter.rb
    Still in use in several importer plugins, but should be phased out, as it
    is unmaintained and mechanize is a much improved modern replacement
  * json (gem: {{{ sudo gem install json }}})                                      
  * mechanize (gem: {{{ sudo gem install mechanize }}})
  * odba (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/odba; cd odba; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})
  * paypal (gem: {{{ sudo gem install paypal }}})
  * racc (gem: {{{ sudo gem install racc }}})
  * rclconf (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/rclconf; cd rclconf;
        ruby install.rb config; ruby install.rb setup;
        sudo ruby install.rb install }}})
  * rmail (gem: {{{ sudo gem install rmail }}})                                    
  * rockit - attached archive:
    http://trac.ywesee.com/attachment/ticket/226/rockit.tar.gz
    Parser generator, should be replaced with racc or another maintained parser
    generator. 
  * rpdf2txt (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/rpdf2txt; cd rpdf2txt;
        ruby install.rb config; ruby install.rb setup;
        sudo ruby install.rb install }}})                                                                
  * rubyzip (gem: {{{ sudo gem install rubyzip }}})                                
  * sbsm (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/sbsm; cd sbsm; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})
  * spreadsheet (gem: {{{ sudo gem install spreadsheet }}}, also a git-project,
    clone and install:
    {{{ git clone git://scm.ywesee.com/sbsm; cd sbsm; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})
  * swissmedic-diff (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/swissmedic-diff; cd swissmedic-diff;
        ruby install.rb config; ruby install.rb setup;
        sudo ruby install.rb install }}})
  * tmail should be replaced with rmail (gem: {{{ sudo gem install tmail }}})
  * ydim (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/ydim; cd ydim; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})
  * yus (git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/yus; cd yus; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})

  Extension projects in ext have the following additional dependencies:
  * facets (gem: {{{ sudo gem install facets }}})
  * hpricot (gem: {{{ sudo gem install hpricot }}})
  * pdf-writer needs to be replaced with [http://github.com/sandal/prawn prawn]
    (gem: {{{ sudo gem install pdf-writer }}}) 
  * rmagick (gem: {{{ sudo gem install rmagick }}})
  * rwv2 (gentoo: {{{ emerge wv2 }}} and git-project, clone and install:
    {{{ git clone git://scm.ywesee.com/rwv2; cd rwv2; ruby install.rb config;
        ruby install.rb setup; sudo ruby install.rb install }}})
  * text-hyphenate (git-project, clone, install the redistributed libhnj and
    install: {{{ git clone git://scm.ywesee.com/text-hyphenate;
                 cd text-hyphenate; ruby install.rb config;
                 ruby install.rb setup; sudo ruby install.rb install }}})

	
Install 
------- 
    * clone the git-repository:
      {{{ git clone ssh://scm.ywesee.com/home/ywesee/git/oddb.org }}}
    * set up an utf-8 encoded database, e.g.:
{{{
hwyss@work ~ $ psql -U postgres
Welcome to psql 8.3.7, the PostgreSQL interactive terminal.

Type:  \copyright for distribution terms
       \h for help with SQL commands
       \? for help with psql commands
       \g or terminate with semicolon to execute query
       \q to quit

postgres=# create user someuser;
CREATE ROLE
postgres=# create database myoddb encoding 'utf8' owner someuser;
CREATE DATABASE
postgres=# \q
}}}
    * set up database-access in etc/db_connection.rb:
{{{
require 'dbi'                                                                     
require 'odba/connection_pool'                                                    
require 'pg'                                            
                        
ODBA.storage.dbi = ODBA::ConnectionPool.new('DBI:Pg:myoddb',             
  'someuser', '') 
}}}
    * read in the data (private download):
{{{ 
zcat oddb.sql.gz | psql -U postgres myoddb
}}}
    * set up the Apache virtual host:
{{{
<Directory path-to-git-repository/doc>
Options ExecCGI FollowSymlinks Indexes
AllowOverride None
Order allow,deny
Allow from all
</Directory>
<Directory path-to-git-repository/data/rss>
Order allow,deny
Allow from all
</Directory>

<VirtualHost *:80>
DocumentRoot path-to-git-repository/doc
ServerName oddb.org.localhost
DirectoryIndex index.rbx
RubyAddPath path-to-git-repository/src
RubyRequire 'sbsm/trans_handler'
SetHandler ruby-object
RubyTransHandler SBSM::FlavoredTransHandler.instance
SetEnv DEFAULT_FLAVOR gcc
</VirtualHost>
}}}
    * start or reload apache
    * run css-updater: {{{ ruby bin/update_css }}}
    * run the server: {{{ ruby bin/oddbd }}}
    * optionally set up dns resolution,
      e.g. add oddb.org.localhost to the localhost line in etc/hosts:
      {{{ 127.0.0.1 localhost oddb.org.localhost }}}

Install Instructions
--------------------

	* http://dev.ywesee.com/wiki.php/Oddb/InstallOddb

Further Information
-------------------
http://trac.ywesee.com/ticket/226

Usage
-----

	* Normal Consumer
	* Health Insurance (Krankenkasse)
	* Pharmacie
	* Hospital
	* Doctor / Physician
	* Pharma Marketing

Background
----------
	
A discussion on http://www.linuxmednews.org 

Post by Zeno: In Switzerland we have the problem that there is only one
provider of the data. And that provider serves all hospitals, doctors,
old age homes, pharmacies etc. As they have the monopoly the could issue
a tax on every transaction that is done with there data; Example: The
docotor in the hospital prescribes one drug to the patient. That info
goes into the system and then gets passed on the specialist (external of
hospital) and then gets passed on to the insurance etc. Imagine you
must pay 50cent for every transaction of the data...  

Post by Tim: This certainly carries some pretty scary scenarios. Are
there not laws to prevent abuse? It would seem that a government
monoploy has been issued here and there would be protections in place.

Post by Zeno: 1. Yes, that is exactly the problem. The company that has
the monopoly also is working for the government and administrating the
database of all drugs that are covered by the public health insurance.
2. I have taken the above issues to antitrust department and the 'price
governing' department of Switzerland. The first pushed the issue to the
second and vice versa. I then contacted the leading consumer
representative of Switzerland and she gave the issue some momentum.  3.
The result of the above is ODDB.org an independent database for
Switzerland. My personal interest is the acceleration of the electronic
data interchange in the healthcare industry. This can only take place on
open standards.

More here:
	
	* http://www.ywesee.com/pmwiki.php/Main/WekoBlog
	* http://www.ywesee.com/pmwiki.php/Main/Bundesgerichtsurteil

License
-------

	* LGPL
	
Source Code Download with GIT
-----------------------------

	* URL: http://scm.ywesee.com/oddb.org

Authors
-------

	* ywesee GmbH

	* Hannes Wyss <hwyss@ywesee.com>
	* Markus Huggler <maege@ywesee.com>
	* Mike Walder <walder@allink.ch> 
	* Raphael Waltert <rwaltert@ywesee.com>
	* Andreas Schrafl <aschrafl@ywesee.com>
	* Benjamin Fay <benfay@ywesee.com> 

README Author
-------------

	* Zeno Davatz <zdavatz@ywesee.com>
